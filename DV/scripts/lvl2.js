function createLvl2Graph(groupYear,groupGenre){d3.json("../data/lvl2.json",function(error,data){data=data.filter(function(d){return d.year===groupYear&&d.genre===groupGenre});var circle_size=Math.min(20/data.length*25,30);var margin={top:-5,right:-5,bottom:-5,left:-5};var width=1000-margin.left-margin.right,height=1000-margin.top-margin.bottom;var force=d3.layout.force().charge(-800).linkDistance(400).size([width,height]);var drag=d3.behavior.drag().origin(function(d){return d}).on("dragstart",dragstarted).on("drag",dragged).on("dragend",dragended);var svg=d3.select("#map").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g")var tip=d3.tip().attr('class','d3-tip').direction("e").offset([0,circle_size/2]).html(function(d){var myString="<p><strong>Songs played:</strong></p><span style='color:lightgray'>";var i=0;while(i<d.tracklist.length){myString=myString+("<p>"+d.tracklist[i]+"</p>");i++}return myString+"</span>"})svg.call(tip);force.nodes(data).start();var container=svg.append("g");var node=container.append("g").attr("class","nodes").selectAll(".node").data(data).enter().append("g").attr("class","node").call(drag);node.append("circle").attr("r",circle_size).attr("class","logo").style("fill","transparent").style("stroke","black").style("stroke-width",1.2);node.append("clipPath").attr('id',function(d,i){return"clip"+i}).append("circle").attr("class","clip-path").attr("r",circle_size);node.append("svg:image").attr("class","circle").attr("xlink:href",d=>"http://www.vector-logo.net/logo_preview/eps/m/Montreux_Jazz_Festival.png").attr("clip-path",function(d,i){return"url(#clip"+i+")"}).attr("x",-circle_size).attr("y",-circle_size).attr("width",circle_size*2).attr("height",circle_size*2);node.append("text").attr("x",0).attr("y",-(circle_size+2)).style("opacity",1).attr("text-anchor","middle").style("fill","#000000").style("font-size","1em").style("font-weight","600").style("stroke","#ffffff").style("stroke-width","0.01em").html(function(d){return d.name});force.on("tick",function(){node.attr("transform",function(d){return"translate("+d.x+","+d.y+")"})});node.on('mouseover',tip.show).on('mouseout',tip.hide);function dragstarted(d){tip.hide();d3.event.sourceEvent.stopPropagation();d3.select(this).classed("dragging",true);force.start()}function dragged(d){tip.hide();d3.select(this).attr("cx",d.x=d3.event.x).attr("cy",d.y=d3.event.y)}function dragended(d){d3.select(this).classed("dragging",false)}});document.getElementById('map').style.opacity=1}